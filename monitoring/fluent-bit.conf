[SERVICE]
    # Intervallo di flush (secondi)
    Flush        1
    # Livello di log del demone Fluent Bit
    Log_Level    info
    Parsers_File parsers.conf

[INPUT]
    Name              tail
    Path              /var/log/shared/app.json
    Tag               nis2.app
    Parser            json
    DB                /var/log/flb_state.db
    Mem_Buf_Limit     5MB
    Skip_Long_Lines   On
    Refresh_Interval  10

[FILTER]
    Name              record_modifier
    Match             *
    Record            hostname ${HOSTNAME}
    Record            service nis2-app
    Record            environment ${ENVIRONMENT}

# === OUTPUT: Console (Development) ===
[OUTPUT]
    Name              stdout
    Match             *
    Format            json_lines

# === OUTPUT: Elasticsearch (Uncomment for production) ===
# [OUTPUT]
#     Name              es
#     Match             *
#     Host              ${ELASTICSEARCH_HOST}
#     Port              9200
#     Index             nis2-logs
#     Type              _doc
#     Logstash_Format   On
#     Logstash_Prefix   nis2
#     Include_Tag_Key   On
#     Tag_Key           _flb_tag

# === OUTPUT: HTTP/SIEM (Uncomment for Intrusa, Splunk HEC, etc.) ===
# [OUTPUT]
#     Name              http
#     Match             *
#     Host              ${SIEM_HOST}
#     Port              443
#     URI               /api/v1/ingest
#     Format            json
#     tls               On
#     tls.verify        On
#     Header            Authorization Bearer ${SIEM_API_TOKEN}